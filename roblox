local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")

-- Update character on respawn
player.CharacterAdded:Connect(function(char)
    character = char
    humanoid = char:WaitForChild("Humanoid")
    hrp = char:WaitForChild("HumanoidRootPart")
end)

-- Settings
local speedEnabled = false
local damageEnabled = true
local damageMultiplier = 5
local healEnabled = true
local maxDistance = 80
local hitboxOffset = Vector3.new(0,3,0)
local hitboxSize = Vector3.new(5,5,5)
local autoAttackDelay = 0.3

-- GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "UltimateFarmGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local function createButton(name,pos,color,text)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(0,150,0,50)
    btn.Position = pos
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.Text = text
    btn.Parent = screenGui
    return btn
end

local speedButton = createButton("SpeedButton", UDim2.new(0,10,0,10), Color3.fromRGB(255,200,50), "Speed (G): OFF")
local healButton = createButton("HealButton", UDim2.new(0,10,0,70), Color3.fromRGB(200,100,100), "Heal (F): ON")
local damageButton = createButton("DamageButton", UDim2.new(0,10,0,130), Color3.fromRGB(255,100,0), "Damage Boost: ON")
local exitButton = createButton("ExitButton", UDim2.new(0,10,0,190), Color3.fromRGB(180,0,0), "Exit")

-- Utility
local function isNPC(model)
    if not model:IsA("Model") then return false end
    if Players:GetPlayerFromCharacter(model) then return false end
    return model:FindFirstChild("Humanoid") and model:FindFirstChild("HumanoidRootPart")
end

local function smoothTeleport(targetCFrame)
    local tween = TweenService:Create(hrp, TweenInfo.new(0.2, Enum.EasingStyle.Linear), {CFrame = targetCFrame})
    tween:Play()
    tween.Completed:Wait()
end

local function dealDamage(targetHumanoid, baseDamage)
    if damageEnabled then
        targetHumanoid:TakeDamage(baseDamage * damageMultiplier)
    else
        targetHumanoid:TakeDamage(baseDamage)
    end
end

-- Auto Farm Loop
local function autoFarm()
    while true do
        for _, npc in ipairs(workspace:GetDescendants()) do
            if isNPC(npc) then
                local npcHRP = npc:FindFirstChild("HumanoidRootPart")
                local npcHum = npc:FindFirstChild("Humanoid")
                if npcHRP and npcHum and npcHum.Health > 0 then
                    local dist = (npcHRP.Position - hrp.Position).Magnitude
                    if dist <= maxDistance then
                        -- ลอยเหนือหัว NPC
                        local targetCFrame = npcHRP.CFrame + hitboxOffset
                        smoothTeleport(targetCFrame)
                        -- โจมตี
                        dealDamage(npcHum, 10)
                        task.wait(autoAttackDelay)
                    end
                end
            end
        end
        task.wait(0.1)
    end
end

-- Button functions
speedButton.MouseButton1Click:Connect(function()
    speedEnabled = not speedEnabled
    speedButton.Text = "Speed (G): "..(speedEnabled and "ON" or "OFF")
end)

healButton.MouseButton1Click:Connect(function()
    if humanoid then
        humanoid.Health = humanoid.MaxHealth
    end
end)

damageButton.MouseButton1Click:Connect(function()
    damageEnabled = not damageEnabled
    damageMultiplier = damageEnabled and 5 or 1
    damageButton.Text = "Damage Boost: "..(damageEnabled and "ON" or "OFF")
end)

exitButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Hotkeys
local UserInputService = game:GetService("UserInputService")
UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.G then speedButton:Activate()
    elseif input.KeyCode == Enum.KeyCode.F then healButton:Activate()
    elseif input.KeyCode == Enum.KeyCode.H then damageButton:Activate()
    end
end)

-- Main Loop
RunService.Stepped:Connect(function()
    if speedEnabled then humanoid.WalkSpeed = 60 else humanoid.WalkSpeed = 16 end
end)

-- Start auto farm
task.spawn(autoFarm)

คุณ, 15:11
-- Services
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

-- Player
local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")
local hrp = character:WaitForChild("HumanoidRootPart")
local camera = Workspace.CurrentCamera

player.CharacterAdded:Connect(function(char)
    character = char
    humanoid = char:WaitForChild("Humanoid")
    hrp = char:WaitForChild("HumanoidRootPart")
end)

-- Settings
local speedEnabled = false
local healEnabled = true
local maxDistance = 80
local hitboxOffset = Vector3.new(0,3,0)
local autoAttackDelay = {0.15,0.3}
local tweenTime = 0.12
local healThreshold = 0.5
local dodgeRange = 2

-- NPC Target List (ชื่อที่ต้องการโจมตี)
local selectableTargets = {"Goblin", "Skeleton", "Boss", "Elite"}

-- RemoteEvent Attack
local attackEvent = ReplicatedStorage:FindFirstChild("AttackEvent")

-- GUI
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SimpleFarmGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

local function createButton(name,pos,color,text)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(0,150,0,50)
    btn.Position = pos
    btn.BackgroundColor3 = color
    btn.TextColor3 = Color3.new(1,1,1)
    btn.Font = Enum.Font.SourceSansBold
    btn.TextSize = 18
    btn.Text = text
    btn.Parent = screenGui
    return btn
end

local speedButton = createButton("SpeedButton", UDim2.new(0,10,0,10), Color3.fromRGB(255,200,50), "Speed (G): OFF")
local healButton = createButton("HealButton", UDim2.new(0,10,0,70), Color3.fromRGB(200,100,100), "Auto Heal: ON")
local exitButton = createButton("ExitButton", UDim2.new(0,10,0,130), Color3.fromRGB(180,0,0), "Exit")

-- Utility
local function isNPC(model)
    if not model:IsA("Model") then return false end
    if Players:GetPlayerFromCharacter(model) then return false end
    if not model:FindFirstChild("Humanoid") or not model:FindFirstChild("HumanoidRootPart") then return false end
    for _, name in ipairs(selectableTargets) do
        if model.Name:match(name) then return true end
    end
    return false
end

local function smoothMove(targetCFrame)
    local tween = TweenService:Create(hrp, TweenInfo.new(tweenTime, Enum.EasingStyle.Linear), {CFrame = targetCFrame})
    tween:Play()
    tween.Completed:Wait()
end

local function humanAttack(npc)
    local npcHRP = npc:FindFirstChild("HumanoidRootPart")
    local npcHum = npc:FindFirstChild("Humanoid")
    if not npcHRP or not npcHum or npcHum.Health <= 0 then return end
    if (npcHRP.Position - hrp.Position).Magnitude > maxDistance then return end

    -- Move above NPC with small random offset
    local offset = hitboxOffset + Vector3.new(math.random()*0.5-0.25,0,math.random()*0.5-0.25)
    smoothMove(npcHRP.CFrame + offset)

    task.wait(autoAttackDelay[1] + math.random()*(autoAttackDelay[2]-autoAttackDelay[1]))

    if attackEvent then
        pcall(function()
            attackEvent:FireServer(npc)
        end)
    end
end

local function autoHeal()
    if healEnabled and humanoid.Health < humanoid.MaxHealth * healThreshold then
        humanoid.Health = humanoid.MaxHealth
    end
end

local function autoDodge()
    local x = (math.random()-0.5) * dodgeRange
    local z = (math.random()-0.5) * dodgeRange
    hrp.CFrame = hrp.CFrame + Vector3.new(x,0,z)
end

local function randomCamera()
    local xRot = (math.random()-0.5)*5
    local yRot = (math.random()-0.5)*5
    camera.CFrame = camera.CFrame * CFrame.Angles(math.rad(xRot), math.rad(yRot), 0)
end

local function autoFarm()
    while true do
        for _, npc in ipairs(Workspace:GetDescendants()) do
            if isNPC(npc) then
                humanAttack(npc)
            end
        end
        autoHeal()
        autoDodge()
        randomCamera()
        task.wait(0.15)
    end
end

-- Buttons
speedButton.MouseButton1Click:Connect(function()
    speedEnabled = not speedEnabled
    speedButton.Text = "Speed (G): "..(speedEnabled and "ON" or "OFF")
end)

healButton.MouseButton1Click:Connect(function()
    healEnabled = not healEnabled
    healButton.Text = "Auto Heal: "..(healEnabled and "ON" or "OFF")
end)

exitButton.MouseButton1Click:Connect(function()
    screenGui:Destroy()
end)

-- Hotkeys
UserInputService.InputBegan:Connect(function(input, gp)
    if gp then return end
    if input.KeyCode == Enum.KeyCode.G then speedButton:Activate()
    elseif input.KeyCode == Enum.KeyCode.F then healButton:Activate()
    end
end)

-- Speed loop
RunService.Stepped:Connect(function()
    humanoid.WalkSpeed = speedEnabled and 60 or 16
end)

-- Start
task.spawn(autoFarm)
