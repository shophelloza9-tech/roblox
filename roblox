local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")

local player = Players.LocalPlayer
local character = player.Character or player.CharacterAdded:Wait()
local humanoid = character:WaitForChild("Humanoid")

player.CharacterAdded:Connect(function(char)
	character = char
	humanoid = char:WaitForChild("Humanoid")
end)

-- UI creation
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "OneClickTeleportGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = player:WaitForChild("PlayerGui")

-- ฟังก์ชันสร้างปุ่มมือถือเล็ก
local function createMiniButton(name, posY, text, color)
	local btn = Instance.new("TextButton")
	btn.Name = name
	btn.Size = UDim2.new(0, 80, 0, 40) -- เล็กลงสำหรับมือถือ
	btn.Position = UDim2.new(0, 10, 0, posY)
	btn.Text = text
	btn.BackgroundColor3 = color
	btn.TextColor3 = Color3.new(1,1,1)
	btn.Font = Enum.Font.SourceSansBold
	btn.TextSize = 14
	btn.Parent = screenGui
	return btn
end

-- สร้างปุ่ม
local teleportButton = createMiniButton("TeleportButton", 50, "Bring Enemies (R)", Color3.fromRGB(0,180,90))
local healButton = createMiniButton("HealButton", 100, "Heal (F)", Color3.fromRGB(200,100,100))
local speedButton = createMiniButton("SpeedButton", 150, "Speed (G): OFF", Color3.fromRGB(255,200,50))
local flyButton = createMiniButton("FlyButton", 200, "Fly (H): OFF", Color3.fromRGB(50,150,255))
local attackButton = createMiniButton("AttackButton", 250, "Auto Attack: OFF", Color3.fromRGB(255,100,50))

-- Settings
local offset = Vector3.new(0,0,-5)
local maxDistance = 80
local speedEnabled = false
local flyEnabled = false
local flySpeed = 50
local bodyVelocity

local autoAttackEnabled = false
local attackDelay = 0.2
local attackEvent = ReplicatedStorage:WaitForChild("AttackEvent") -- เปลี่ยนให้ตรงกับเกม

-- ฟังก์ชันต่าง ๆ เหมือนเดิม (teleport, heal, fly, speed, auto attack)
-- ตัวอย่างฟังก์ชัน toggle

local function toggleSpeed()
	speedEnabled = not speedEnabled
	speedButton.Text = "Speed (G): "..(speedEnabled and "ON" or "OFF")
end

local function toggleFly()
	flyEnabled = not flyEnabled
	flyButton.Text = "Fly (H): "..(flyEnabled and "ON" or "OFF")
	local hrp = character:FindFirstChild("HumanoidRootPart")
	if not hrp then return end
	if flyEnabled then
		bodyVelocity = Instance.new("BodyVelocity")
		bodyVelocity.MaxForce = Vector3.new(1e5,1e5,1e5)
		bodyVelocity.Velocity = Vector3.new(0,0,0)
		bodyVelocity.Parent = hrp
	else
		if bodyVelocity then bodyVelocity:Destroy() bodyVelocity=nil end
	end
end

local function toggleAutoAttack()
	autoAttackEnabled = not autoAttackEnabled
	attackButton.Text = "Auto Attack: "..(autoAttackEnabled and "ON" or "OFF")
end

-- Connect buttons
teleportButton.MouseButton1Click:Connect(function() pcall(teleportNearbyNPCs) end)
healButton.MouseButton1Click:Connect(function() pcall(healPlayer) end)
speedButton.MouseButton1Click:Connect(toggleSpeed)
flyButton.MouseButton1Click:Connect(toggleFly)
attackButton.MouseButton1Click:Connect(toggleAutoAttack)

-- Hotkeys
UserInputService.InputBegan:Connect(function(input, gameProcessed)
	if gameProcessed then return end
	if input.KeyCode == Enum.KeyCode.R then teleportNearbyNPCs()
	elseif input.KeyCode == Enum.KeyCode.F then healPlayer()
	elseif input.KeyCode == Enum.KeyCode.G then toggleSpeed()
	elseif input.KeyCode == Enum.KeyCode.H then toggleFly()
	elseif input.KeyCode == Enum.KeyCode.T then toggleAutoAttack()
	end
end)
